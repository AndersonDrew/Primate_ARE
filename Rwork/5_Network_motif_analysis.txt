##use pegas and import list of motifs

library(pegas)
motif<-read.dna("/Users/andersond/Desktop/Primate/motifs.fasta",format = "fasta")
mot<-haplotype(motif)
rownames(mot)<-rownames(motif)
motnet<-haploNet(mot)
motnet[]
#            step      Prob
# [1,]  6  1    1 0.9636119
# [2,] 14  7    1 0.9636119
# [3,] 11 10    1 0.9636119
# [4,] 12 11    1 0.9636119
# [5,] 15 11    1 0.9636119
# [6,] 16 11    1 0.9636119
# [7,]  4  1    2 0.8927557
# [8,]  6  3    2 0.8927557
# [9,] 15  6    2 0.8927557
#[10,] 10  7    2 0.8927557
#[11,] 13  9    2 0.8927557
#[12,] 18 15    2 0.8927557
#[13,]  6  2    3 0.7931866
#[14,] 11  5    3 0.7931866
#[15,]  8  6    3 0.7931866
#[16,]  9  8    3 0.7931866
#[17,] 17  1    4 0.6738089
#attr(,"freq")
# [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#attr(,"labels")
# [1] "hklk"  "mvdp"  "p21"   "pem1"  "pem2"  "psa1"  "psa3"  "sc12"  "slp2"  "slp3"  "aSRE"  "cSRE"  "ccnd1" "hk2"  "cARE"  "aARE"  "pb2"   "c3"   
#attr(,"alter.links")
#            step      Prob
# [1,] 12  7    2 0.8927557
# [2,] 16  7    2 0.8927557
# [3,] 12 10    2 0.8927557
# [4,] 15 10    2 0.8927557
# [5,] 16 10    2 0.8927557
# [6,] 15 12    2 0.8927557
# [7,] 16 12    2 0.8927557
# [8,] 16 15    2 0.8927557
# [9,]  3  1    3 0.7931866
#[10,] 14  1    3 0.7931866
#[11,] 15  1    3 0.7931866
#[12,] 16  1    3 0.7931866
#[13,] 11  2    3 0.7931866
#[14,] 15  2    3 0.7931866
#[15,] 15  3    3 0.7931866
#[16,]  6  4    3 0.7931866
#[17,] 15  4    3 0.7931866
#[18,] 16  4    3 0.7931866
#[19,] 15  5    3 0.7931866
#[20,] 11  6    3 0.7931866
#[21,] 12  6    3 0.7931866
#[22,] 11  7    3 0.7931866
#[23,] 13  8    3 0.7931866
#[24,] 14 10    3 0.7931866
#[25,] 18 11    3 0.7931866
#[26,] 14 12    3 0.7931866
#[27,] 15 14    3 0.7931866
#[28,] 16 14    3 0.7931866
#[29,]  2  1    4 0.6738089
#[30,]  7  1    4 0.6738089
#[31,]  8  1    4 0.6738089
#[32,] 11  1    4 0.6738089
#[33,] 12  1    4 0.6738089
#[34,]  4  2    4 0.6738089
#[35,]  5  2    4 0.6738089
#[36,] 10  2    4 0.6738089
#[37,] 12  2    4 0.6738089
#[38,] 16  2    4 0.6738089
#[39,]  8  3    4 0.6738089
#[40,] 11  3    4 0.6738089
#[41,] 12  3    4 0.6738089
#[42,] 18  3    4 0.6738089
#[43,]  8  4    4 0.6738089
#[44,] 11  4    4 0.6738089
#[45,] 14  4    4 0.6738089
#[46,]  9  5    4 0.6738089
#[47,] 10  5    4 0.6738089
#[48,] 12  5    4 0.6738089
#[49,] 16  5    4 0.6738089
#[50,] 18  5    4 0.6738089
#[51,] 10  6    4 0.6738089
#[52,] 14  6    4 0.6738089
#[53,] 16  6    4 0.6738089
#[54,] 18  6    4 0.6738089
#[55,] 15  7    4 0.6738089
#[56,] 11  8    4 0.6738089
#[57,] 12  8    4 0.6738089
#[58,] 11  9    4 0.6738089
#[59,] 12  9    4 0.6738089
#[60,] 15  9    4 0.6738089
#[61,] 18 10    4 0.6738089
#[62,] 14 11    4 0.6738089
#[63,] 18 12    4 0.6738089
#[64,] 18 16    4 0.6738089

##generate plot for haplotype network

back<-c("red","gray50","gray72","gray72","cyan3","gray50","red","gray72","gray50","gray72","gray72","gray50","dodgerblue","dodgerblue","cyan3","gray72","gray72","gray72")
fon.val=c(3,3,3,2,2,3,3,2,2,3,3,3,2,3,3,3,2,3)
wid<-c(5,5,5,5,5,5,3,3,3,3,3,3,1,1,1,1,0.5)

setEPS()
postscript("/Users/andersond/Desktop/Primate/HaploFig.eps")
par(mar=c(1,1,1,1))
plot(motnet,size=1.5,show.mutation=1,fast=FALSE,threshold=c(0,1),scale.ratio=1,cex=.8,lty=1,lwd=wid,bg=back,font=fon.val)
dev.off()
